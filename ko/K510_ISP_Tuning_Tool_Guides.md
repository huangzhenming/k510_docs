![](../zh/images/canaan-cover.png)

**<font face="黑体" size="6" style="float:right">K510 ISP 튜닝 도구 가이드</font>**

<font face="黑体"  size=3>문서 버전: V1.0.0</font>

<font face="黑体"  size=3>게시 날짜: 2022-03-31</font>

<div style="page-break-after:always"></div>

<font face="黑体" size=3>**면책 조항**</font>
귀하가 구매한 제품, 서비스 또는 기능은 베이징 Jiananges 정보 기술 유한 회사(이하 "회사")의 상업 계약 및 약관의 적용을 받으며, 이 문서에 설명된 제품, 서비스 또는 기능의 전부 또는 일부는 구매 또는 사용의 범위를 벗어납니다. 계약에 달리 합의하지 않는 한, 회사는 본 문서의 진술, 정보, 내용의 정확성, 신뢰성, 완전성, 마케팅, 특정 목적 및 비침략성에 대해 명시적 또는 묵시적으로 어떠한 진술이나 보증도 하지 않습니다. 달리 합의하지 않는 한, 이 문서는 사용 지침의 참조로만 사용됩니다.
이 문서의 내용은 제품 버전 업그레이드 또는 기타 이유로 인해 예고 없이 수시로 업데이트되거나 수정될 수 있습니다.

**<font face="黑体"  size=3>상표 고지</font>**

베이징 <img src="../zh/images/canaan-logo.png" style="zoom:33%;" />Jianan Jets 정보 기술 유한 공사의 상표는 Jianan, Jianan 및 Jianan의 다른 상표입니다. 이 문서에 언급될 수 있는 기타 모든 상표 또는 등록 상표는 해당 소유자가 소유합니다.

**<font face="黑体"  size=3>저작권 ©2022 베이징 Jiananjets 정보 기술 유한 회사</font>**
이 문서는 K510 플랫폼 개발 및 설계에만 적용되며, 어떠한 단위나 개인도 회사의 서면 허가 없이 이 문서의 일부 또는 전부를 어떤 형태로든 배포할 수 없습니다.

**<font face="黑体"  size=3>베이징 Jiananjets 정보 기술 유한 회사</font>**
웹 사이트: canaan-creative.com
비즈니스 문의: salesAI@canaan-creative.com

<div style="page-break-after:always"></div>
# 서문
**<font face="黑体"  size=5>문서의 목적</font>**
이 문서는 ISP Tuning Tool 설명서입니다.

**<font face="黑体"  size=5>독자 개체입니다</font>**

이 문서의 주요 대상은 개인 응용 프로그램 및 드라이버를 구현하려는 숙련된 소프트웨어 엔지니어, 이미지 알고리즘 엔지니어, 시스템 설계자 및 시스템 통합업체입니다.

**<font face="黑体"  size=5>레코드를 수정합니다</font>**
 <font face="宋体"  size=2>개정 레코드에는 각 문서 업데이트에 대한 설명이 누적됩니다. 문서의 최신 버전에는 이전 버전의 모든 업데이트가 포함되어 있습니다. </font>

| 버전 번호입니다   | 수정자     | 개정일입니다 | 개정 지침 |
|  :-----  |-------   |  ------  |  ------  |
| V1.0.0 | 시스템 소프트웨어 그룹입니다 | 2022-03-31 | SDK V1.6이 릴리스되었습니다 |

<div style="page-break-after:always"></div>
**<font face="黑体"  size=6>카탈로그</font>**

[목차]

<div style="page-break-after:always"></div>

# ISP 튜닝 도구 프레임워크에 대한 소개입니다

이 섹션에서는 전체 ISP 이미지 최적화를 제어하기 위해 상위 프로세서에서 사용할 수 있는 ISP 튜닝 도구 및 데이터 흐름에 대한 설명에 대해 설명합니다.

```text
+----------------------------------------------------+
|                                                    |
|                      K510                          |
|                                                    |
|    +-------+        +--------------------------+   |
|    |       |        |                          |   |
|    |  ISP  +------> |   v4l2_drm_isptool.out   |   |
|    |       |        |                          |   |
|    +-------+        +-------------+------------+   |
|                                   |                |
|                                   |                |
|    +-----------------+            |                |
|    |                 |            |                |
|    |   isp-tuningd   | <----------+                |
|    |                 |                             |
|    +^-+--------------+                             |
|     | |                                            |
|     | |                                            |
+----------------------------------------------------+
      | |
      | |
+-------------------------------+
|     | |                       |
|     | |       PC              |
|     | |                       |
|    ++-v------------------+    |
|    |                     |    |
|    |  ISP Tuning Tool    |    |
|    |                     |    |
|    +---------------------+    |
|                               |
+-------------------------------+
```

## 도구 데이터 흐름을 조정합니다

통신 프로토콜은 클라이언트 코드 리포지토리의 설명서를 참조하십시오. 도구는 PC에서 실행되는 클라이언트 isp-tuningd, /app/mediactl_lib/isp-tuningd 및 K510에서 실행되는 서비스 쪽의 두 부분으로 구성됩니다. 통신은 기본적으로 TCP의 9982 포트를 사용합니다.

### 클라이언트입니다

ISP Tuning Tool은 PC에서 실행되는 응용 프로그램입니다. 레지스터를 설정할 수 있을 뿐만 아니라 AWB 교정 및 CCM 교정도 지원됩니다.

### 서버 측

isp-tuningd는 표준 입력에서 3133440바이트 크기의 yuv 이미지(NV12)를 수신하고 모든 클라이언트에 브로드캐스트하며, v4l2_drm_isptool 사용하여 isp-tuningd를 자동으로 시작하고 v4l2_drm 동일한 방식으로 이미지 데이터를 전송합니다. 우리는 다음과 같은 명령으로 실행할 수 있습니다

```shell
cd /app/mediactl_lib
./v4l2_drm_isptool -f video_drm_1080x1920.conf
```

# ISP 튜닝 옵션

K510 ISP에는 제어 및 튜닝을 위한 많은 레지스터와 테이블이 있습니다. ISP 하드웨어 레지스터의 설정은 이미지 품질에 매우 중요합니다. 현재 K510 플랫폼에서 이미지 튜닝 프로세스는 TCP Socket을 통해서만 달성할 수 있습니다.

## 튜닝 도구의 기본 창입니다

이 섹션에서는 조정 창에서 이러한 패널의 기능에 대해 설명합니다.

그림 3-1은 튜닝 창의 전체 운영자 패널을 보여 줍니다

- 패널 1은****구성된 ISP 파일을 로드하거나 보정하도록 선택할 수 있는 메뉴입니다.
- 패널2는 **연결 제어판**으로 보드의 IP 주소와 포트 번호(기본 9982포트)를 입력한 뒤 녹색 연결 버튼을 누르면 연결이 된다.
- 패널 3은 **레지스터 패널이며**레지스터를 설정하거나 읽어야 하는 경우 이 패널을 사용하여 설정하고 읽을 수 있습니다.
- 패널(4)은 조정 **파라미터 선택 패널이며**, 사용자는 패널 프롬프트 텍스트에 따라 다양한 파라미터 또는 파라미터 그룹을 선택할 수 있으며, 이들 선택된 레지스터는 패널(5)에 표시됩니다.
- 패널 5는 **튜닝 서버에서 매개 변수**값을 설정하거나 가져오는 데 사용되는 튜닝 매개 변수 설정 패널입니다.
- 패널 6은****ISP 출력의 이미지를 표시하는 이미지 디스플레이 패널이며, 항상 재생할 필요가 없는 경우 중간 일시 중지 버튼을 클릭할 수 있습니다.

![그림 3-1 튜닝 도구의 주 창입니다](../zh/images/sdk_application/clip_image033.png)

ISP Tuning Tool은 연결 후****모든 레지스터 값을 자동으로 가져오지 않으며, 필요한 경우**연결 제어판**의 오른쪽에 있는 읽기 버튼을 클릭하여 현재 레지스터 값을 모두 가져올 수 있습니다.

# 교정 및 교정

이 섹션에서는 자동 화이트 밸런스(AWB), 색상 보정 매트릭스(CCM), 감마 및 렌즈 그림자(LSC)를 포함하여 ISP 튜닝 도구를 사용하여 교정 및 교정에 대한 지침을 제공합니다.

## 증권 시세 표시기

### 준비

1. 표준 D65 광원이 있는 표준 라이트 박스
2. 표준 24색 카드는 현재 X-RITE 컬러 카드만 지원합니다
3. sensor 원본 이미지 또는 처리된 이미지를 출력할 수 있는 교정 카메라를 준비합니다
4. ISP는 또한 블랙 레벨 보정 및 모자이크 알고리즘 모듈, CSC 및 기타 형식 변환 모듈을 열 때 대칭 (매트릭스는 역 매트릭스)에주의를 기울여야하며 노이즈 감소, 선명하게 하기 및 기타 모듈은 거의 영향을 미치지 않지만 비선형 모듈 및 색상 처리 모듈 (GAMMA, 와이드 다이나믹, AWB, CCM, 채도 조정 등)을 닫아야합니다

### 이미지를 가져옵니다

1. 카메라는 24색 카드를 조준하여 24색 카드가 전체 화면을 가득 채우고 이미지를 캡처하여 아래 그림과 같이 재생을 일시 중지하기 위해 클릭할 수 있다는 보장이 없습니다

    ![그림 4-1은 24색 카드를 촬영합니다](../zh/images/sdk_application/clip_image014.jpg)

2. 캡처된 이미지는 밝고 어두운 가운데에 있으며 너무 밝거나 너무 어두워도 교정에 영향을 줍니다

### 캘리딩

메뉴 모음에서 [Calibration]을 클릭하고 [AWB]를 선택하여 교정을 수행하면 프로그램이 자동으로 색상 카드를 프레임합니다

![그림 4-2 자동 상자 색상 카드](../zh/images/sdk_application/clip_image016.jpg)

이 시점에서 키를 눌러 계속하면 화이트 밸런스가 완료된 이미지가 나타납니다

![그림 4-3은 AWB 교정을 완료합니다](../zh/images/sdk_application/clip_image018.jpg)

문제가 해결되지 않은 경우 키를 계속 누르면 도구 팝업 대화 상자가 매개 변수가 적절한지 묻는 메시지를 표시하고, 예, 기본 인터페이스 관련 레지스터로 채우거나, 교정 결과를 포기하고, 그렇다면 도구가 장치 레지스터에 쓸지 여부를 계속 묻습니다.

## 증권 시세  표시기

AWB 교정과 일치하며 반복되지 않습니다.

## 감마

표준 감마 곡선의 공식은 다음과 같습니다
$$
Y=aX^b
$$
여기서 $b$는 Gamma 계수이며, 일반적으로 이미징 측면에서 1보다 작으며 디스플레이 측면에서는 일반적으로 1보다 큽니다. $a$의 값은 $b$의 값을 기준으로 계산할 수 있습니다

$$
a=\frac{256}{256^b}
$$
이 공식의 원리는 입력이 256이고 감마 교정이 완료 된 후에도 256입니다.

감마 계수 b가 0.5이면 곡선은 다음 그림과 같습니다

![](../zh/images/sdk_application/clip_image025.png)

## 증권  시세 표시기

### 준비

- 하나의 샷으로 얻은 RAW 형식의 사진

### 원리

렌즈의 중심이 주변 광속과 일치하지 않아 이미지 밝기가 고르지 않기 때문에 곡선 피팅을 통해 보정 표면을 생성하여 문제를 해결합니다.

교정 전은 아래 그림과 같습니다

![수정하기 전에](../zh/images/sdk_application/clip_image029.png)

교정 후 아래 그림과 같이 표시됩니다

![보정 후](../zh/images/sdk_application/clip_image031.png)

**번역 면책 조항**  
고객의 편의를 위해 Canan은 AI 번역 프로그램을 사용하여 오류를 포함할 수 있는 여러 언어로 텍스트를 번역합니다. 당사는 제공된 번역의 정확성, 신뢰성 또는 적시성을 보장하지 않습니다. Canan은 번역된 정보의 정확성이나 신뢰성에 의존하여 발생하는 손실이나 손해에 대해 책임을 지지 않습니다. 언어 번역 간에 콘텐츠 차이가 있는 경우 중국어 간체 버전이 우선합니다.

번역 오류 또는 부정확한 문제를 신고하려면 이메일로 문의하시기 바랍니다.
